

@move-highlight: #2a7bde;
@hover-highlight: #8bc34a;
@drop-highlight: #ffeb3b;
@threaten-highlight: #f44336;
@highlight-alpha: 35%;

@light-space: #cab17c;
@dark-space: #8c7034;

@quantum-label: #f44336;

@square-size: 80px;

.flex-horiz {
  display: flex;
  flex-direction: row;
}

.flex-vert {
  display: flex;
  flex-direction: column;
}

.flex-spacer {
  flex-grow: 1;
}

.no-select {
  -webkit-user-select:none;
  -khtml-user-drag:none;
  -khtml-user-select:none;
  -moz-user-select:none;
  -moz-user-select:-moz-none;
  -ms-user-select:none;
  user-select:none;
}

.board {
  .no-select;
  cursor: default;
  table-layout: fixed;
  border-width: 0px;
  border-collapse: collapse;

  td, th {
    padding: 0px;
    margin: 0px;
    border-width: 0px;
  }

  .board-space {
    vertical-align: top;
    .mixin--board-space(@base-color) {
      background-color: @base-color;
      .mixin--highlight(@highlight) {
        background-color: mix(@highlight, @base-color, @highlight-alpha);
      }
      &:hover:empty {
        .mixin--highlight(@hover-highlight);
      }
      &.legal-move {
        .mixin--highlight(@move-highlight);
      }
      &.threatened {
        .mixin--highlight(@threaten-highlight);
      }
      &.drop {
        .mixin--highlight(@drop-highlight) !important;
      }
    }
    &.light {
      .mixin--board-space(@light-space);
    }
    &.dark {
      .mixin--board-space(@dark-space);
    }
    &.square {
      width: @square-size;
      height: @square-size;
      overflow: hidden;
    }
  }

  .board-header {
    font-size: @square-size * 0.3;
    font-family: sans-serif;
    text-align: center;

    &.file {
      width: @square-size;
      height: @square-size * 0.4;
    }

    &.rank {
      height: @square-size;
      width: @square-size * 0.4;
    }
  }
}

.piece {
  position: relative;
  width: @square-size;
  height: @square-size;
  margin: auto;
  background-repeat: no-repeat;
  background-size: cover;

  &:hover:not(.captured) {
    filter: url("assets/filters.svg#blue-glow");
  }

  &.threatened {
    filter: url("assets/filters.svg#red-glow");
  }

  &.protected {
    filter: url("assets/filters.svg#yellow-glow");
  }

  @piece-types: king, queen, bishop, knight, rook, pawn;
  .loop(@t) when (@t > 0) {
    .loop((@t - 1));
    @type: extract(@piece-types, @t);

    &.@{type}{
      &.white {
        background-image: url("assets/pieces.svg#white-@{type}");
      }
      &.black {
        background-image: url("assets/pieces.svg#black-@{type}");
      }
    }
  }
  .loop(length(@piece-types));

  &.quantum {
    @size: @square-size / 2;
    @text-size: @square-size / 3.5;
    width: @size;
    height: @size;
    margin: 0px;
    display: inline-block;
    vertical-align: bottom;
    line-height: @size + @text-size;
    text-align: right;
    font-family: monospace;
    font-size: @text-size;
    text-shadow: 0 0 3px darken(@quantum-label, 20%), 0 0 5px darken(@quantum-label, 50%);
    color: @quantum-label;
  }
}

.graveyard {
  border: 1px solid black;
  width: @square-size * 2.5;
  height: @square-size * 2;
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  justify-content: flex-start;
  align-items: flex-start;

  .piece {
    @size: @square-size / 2;
    width: @size;
    height: @size;
    margin: 0;
  }
}

#turn-indicator-container {
  height: @square-size;
  align-items: center;
  justify-content: center;
  font-family: sans-serif;
  font-size: @square-size / 5;
}

#turn-indicator {
  @size: @square-size * 0.7;
  width: @size;
  height: @size;
  display: flex;
  justify-content: center;
  align-items: center;
  background-repeat: no-repeat;
  background-size: cover;
  font-size: 0;

  &.white {
    background-image: url("assets/pieces.svg#white-king");
  }
  &.black {
    background-image: url("assets/pieces.svg#black-king");
  }
}
